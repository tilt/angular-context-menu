angular.module("ng-context-menu",[]).factory("ngContextMenu",["$q","$http","$compile","$templateCache","$animate","$rootScope","$controller",function(e,t,n,o,r,a,l){return function(c){function i(e,t){return g&&e&&p(e),s.then(function(n){return $||u(n,e),t&&$.css(t),$})}function u(e,t){if(h=angular.element(c.container||document.body),$=angular.element(e),0===$.length)throw new Error("The template contains no elements; you need to wrap text nodes");r.enter($,h),g=a.$new(),t&&p(t);var o=l(v,{$scope:g});d&&(g[d]=o),n($)(g)}function p(e){for(var t in e)g[t]=e[t]}function f(){var t=e.defer();return $?r.leave($,function(){g.$destroy(),$=null,t.resolve()}):t.resolve(),t.promise}function m(){return!!$}if(!(!c.template^!c.templateUrl))throw new Error("Expected context menu to have exacly one of either `template` or `templateUrl`");var s,g,v=(c.template,c.controller||angular.noop),d=c.controllerAs,$=null,h=null;if(c.template){var x=e.defer();x.resolve(c.template),s=x.promise}else s=t.get(c.templateUrl,{cache:o}).then(function(e){return e.data});return{open:i,close:f,active:m}}}]).directive("hasContextMenu",["$injector","$window","$parse",function(e,t){return{restrict:"A",link:function(n,o,r){function a(e){p.open(f,c(e))}function l(){p.close()}function c(e){return{top:Math.max(e.pageY,0)+"px",left:Math.max(e.pageX,0)+"px"}}function i(e){p.active()&&u&&2!==e.button&&n.$apply(function(){l()})}var u,p=e.get(r.target),f={},m=angular.element(t),s=r.triggerOnEvent||"contextmenu";if(r.locals){var g=r.locals.split(",").map(function(e){return e.trim()});angular.forEach(g,function(e){f[e]=n[e]})}o.bind(s,function(e){u=e.target,e.preventDefault(),e.stopPropagation(),n.$apply(function(){a(e)})}),m.bind("keyup",function(e){p.active()&&27===e.keyCode&&n.$apply(function(){l()})}),m.bind("click",i),m.bind(s,i)}}}]);